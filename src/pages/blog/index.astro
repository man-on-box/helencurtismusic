---
import { getCollection, getEntry } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Surface from "../../components/Surface.astro";
import Banner from "../../components/HeroBanner.astro";
import Card from "../../components/Card.astro";

const { data, render } = await getEntry("pages", "blog");
const blogEntries = (await getCollection("blogs")).reverse();
const { Content } = await render();
---

<Layout title={data.heading}>
  <div class="container px-5 mx-auto">
    <div class="flex justify-center">
      <Banner
        heading={data.heading}
        subheading={data.subheading}
        imgSrc="/images/beach-830-830.webp"
        imgAlt="Picture of beach"
        imgWidth={350}
        imgHeight={350}
      />
    </div>
    <div class="flex justify-center gap-8">
      <Surface class="grow max-w-4xl">
        <article class="prose mb-8">
          <Content />
        </article>
        <div class="max-w-1xl">
          {
            blogEntries.map((entry) => (
              <a title={entry.data.title} href={`/blog/${entry.slug}`}>
                <Card
                  heading={entry.data.title}
                  subheading={entry.data.date}
                  imgSrc={entry.data.image}
                >
                  <p>{entry.body.slice(0, 200)}...</p>
                </Card>
              </a>
            ))
          }
        </div>
      </Surface>
    </div>
  </div>
</Layout>
